<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Rate Calculator - Effective Rupees</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-50 min-h-screen">
    <div x-data="goldCalculator()" class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <span class="text-yellow-600">ðŸ’°</span> Gold Rate Calculator
            </h1>
            <p class="text-gray-600">Calculate effective rupees based on gold prices</p>
        </div>

        <!-- Main Card -->
        <div class="bg-white rounded-2xl shadow-xl p-8 mb-6">
            <!-- Input Form -->
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <!-- Source Year -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Source Year
                    </label>
                    <select 
                        x-model="sourceYear" 
                        @change="calculate()"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition-all"
                    >
                        <option value="">Select Year</option>
                        <template x-for="year in years" :key="year">
                            <option :value="year" x-text="year"></option>
                        </template>
                    </select>
                    <p x-show="sourceYear" class="mt-2 text-sm text-gray-500">
                        Gold Price: â‚¹<span x-text="getPrice(sourceYear)"></span>/10g
                    </p>
                </div>

                <!-- Target Year -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Target Year
                    </label>
                    <select 
                        x-model="targetYear" 
                        @change="calculate()"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition-all"
                    >
                        <option value="">Select Year</option>
                        <template x-for="year in years" :key="year">
                            <option :value="year" x-text="year"></option>
                        </template>
                    </select>
                    <p x-show="targetYear" class="mt-2 text-sm text-gray-500">
                        Gold Price: â‚¹<span x-text="getPrice(targetYear)"></span>/10g
                    </p>
                </div>

                <!-- Amount -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                        Amount (â‚¹)
                    </label>
                    <input 
                        type="number" 
                        x-model="amount" 
                        @input="calculate()"
                        placeholder="Enter amount"
                        min="0"
                        step="0.01"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 transition-all"
                    >
                </div>
            </div>

            <!-- Result Card -->
            <div x-show="result !== null" 
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform scale-95"
                 x-transition:enter-end="opacity-100 transform scale-100"
                 class="bg-gradient-to-r from-yellow-400 to-amber-500 rounded-xl p-6 text-white">
                <div class="text-center">
                    <p class="text-lg font-semibold mb-2">Effective Amount</p>
                    <p class="text-4xl font-bold mb-2">
                        â‚¹<span x-text="formatNumber(result)"></span>
                    </p>
                    <p class="text-sm opacity-90">
                        <span x-text="formatNumber(amount)"></span> in <span x-text="sourceYear"></span> 
                        â‰ˆ <span x-text="formatNumber(result)"></span> in <span x-text="targetYear"></span>
                    </p>
                    <div class="mt-4 pt-4 border-t border-white/30">
                        <p class="text-sm">
                            Multiplier: <span class="font-bold" x-text="multiplier.toFixed(2)"></span>x
                        </p>
                    </div>
                </div>
            </div>

            <!-- Error Message -->
            <div x-show="error" 
                 x-transition
                 class="mt-4 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded">
                <p x-text="error"></p>
            </div>
        </div>

        <!-- Info Card -->
        <div class="bg-white rounded-2xl shadow-lg p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">How it works</h2>
            <p class="text-gray-600 mb-2">
                This calculator converts an amount from one year to another based on gold prices. 
                It calculates how much gold you could buy with the source amount, then shows 
                what that same amount of gold would cost in the target year.
            </p>
            <p class="text-gray-600 text-sm">
                Formula: <code class="bg-gray-100 px-2 py-1 rounded">(Amount Ã· Source Year Gold Price) Ã— Target Year Gold Price</code>
            </p>
        </div>
    </div>

    <script>
        function goldCalculator() {
            return {
                goldRates: [],
                years: [],
                sourceYear: '',
                targetYear: '',
                amount: '',
                result: null,
                multiplier: 0,
                error: '',

                async init() {
                    try {
                        const response = await fetch('gold-rate.json');
                        this.goldRates = await response.json();
                        this.years = this.goldRates.map(rate => rate.year).sort((a, b) => a - b);
                    } catch (err) {
                        this.error = 'Failed to load gold rate data. Please ensure gold-rate.json is available.';
                        console.error(err);
                    }
                },

                getPrice(year) {
                    if (!year) return '0';
                    const rate = this.goldRates.find(r => r.year === year);
                    return rate ? parseFloat(rate.price).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : '0';
                },

                calculate() {
                    this.error = '';
                    this.result = null;
                    this.multiplier = 0;

                    if (!this.sourceYear || !this.targetYear || !this.amount) {
                        return;
                    }

                    if (this.sourceYear === this.targetYear) {
                        this.result = parseFloat(this.amount);
                        this.multiplier = 1;
                        return;
                    }

                    const sourceRate = this.goldRates.find(r => r.year === this.sourceYear);
                    const targetRate = this.goldRates.find(r => r.year === this.targetYear);

                    if (!sourceRate || !targetRate) {
                        this.error = 'Gold rate data not available for selected years.';
                        return;
                    }

                    const sourcePrice = parseFloat(sourceRate.price);
                    const targetPrice = parseFloat(targetRate.price);
                    const amountValue = parseFloat(this.amount);

                    if (isNaN(amountValue) || amountValue < 0) {
                        this.error = 'Please enter a valid amount.';
                        return;
                    }

                    if (sourcePrice === 0) {
                        this.error = 'Source year gold price is invalid.';
                        return;
                    }

                    // Calculate: (amount / source_price) * target_price
                    const goldUnits = amountValue / sourcePrice;
                    this.result = goldUnits * targetPrice;
                    this.multiplier = targetPrice / sourcePrice;
                },

                formatNumber(num) {
                    if (num === null || num === undefined) return '0.00';
                    return parseFloat(num).toLocaleString('en-IN', { 
                        minimumFractionDigits: 2, 
                        maximumFractionDigits: 2 
                    });
                }
            }
        }
    </script>
</body>
</html>

