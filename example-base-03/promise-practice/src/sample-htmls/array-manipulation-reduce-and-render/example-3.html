<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <title>Document</title>
  </head>
  <body>
    <pre id="myPre"></pre>

    <script>
      //////////////////////////////////////////////////////////

      const employeeData = [
        {
          id: 1,
          employeeCode: "1000001",
          name: "John Doe",
          dob: "1990-01-01",
          designation: "Software Engineer",
          department: "IT",
          skills: ["JavaScript", "React", "Node.js"],
          languages: ["English", "Spanish"],
        },
        {
          id: 2,
          employeeCode: "1000002",
          name: "Jane Smith",
          dob: "1985-05-15",
          designation: "Project Manager",
          department: "Management",
          skills: ["Project Management", "Agile", "Scrum"],
          languages: ["English", "French"],
        },
        {
          id: 3,
          employeeCode: "1000003",
          name: "Alice Johnson",
          dob: "1992-03-22",
          designation: "UX Designer",
          department: "Design",
          skills: ["UI/UX", "Photoshop", "Sketch"],
          languages: ["English", "German"],
        },
        {
          id: 4,
          employeeCode: "1000004",
          name: "Bob Brown",
          dob: "1988-11-30",
          designation: "DevOps Engineer",
          department: "IT",
          skills: ["AWS", "Docker", "Kubernetes"],
          languages: ["English", "Chinese"],
        },
        {
          id: 5,
          employeeCode: "1000005",
          name: "Eve White",
          dob: "1995-07-12",
          designation: "Data Scientist",
          department: "Data",
          skills: ["Python", "Machine Learning", "Statistics"],
          languages: ["English", "Japanese"],
        },
        {
          id: 6,
          employeeCode: "1000006",
          name: "Charlie Green",
          dob: "1987-09-05",
          designation: "Business Analyst",
          department: "Business",
          skills: ["Analysis", "Excel", "SQL"],
          languages: ["English", "Russian"],
        },
        {
          id: 7,
          employeeCode: "1000007",
          name: "David Black",
          dob: "1993-02-17",
          designation: "Backend Developer",
          department: "IT",
          skills: ["Java", "Spring", "Hibernate"],
          languages: ["English", "Italian"],
        },
        {
          id: 8,
          employeeCode: "1000008",
          name: "Fiona Blue",
          dob: "1991-06-25",
          designation: "Frontend Developer",
          department: "IT",
          skills: ["HTML", "CSS", "JavaScript"],
          languages: ["English", "Korean"],
        },
        {
          id: 9,
          employeeCode: "1000009",
          name: "George Yellow",
          dob: "1989-12-19",
          designation: "QA Engineer",
          department: "Quality Assurance",
          skills: ["Testing", "Automation", "Selenium"],
          languages: ["English", "Portuguese"],
        },
        {
          id: 10,
          employeeCode: "1000010",
          name: "Helen Purple",
          dob: "1994-08-08",
          designation: "HR Manager",
          department: "Human Resources",
          skills: ["Recruitment", "Employee Relations", "HR Policies"],
          languages: ["English", "Spanish"],
        },
        {
          id: 11,
          employeeCode: "1000011",
          name: "Ian Cyan",
          dob: "1990-04-14",
          designation: "Systems Administrator",
          department: "IT",
          skills: ["Linux", "Networking", "Security"],
          languages: ["English", "Arabic"],
        },
        {
          id: 12,
          employeeCode: "1000012",
          name: "Jill Orange",
          dob: "1986-10-27",
          designation: "Marketing Specialist",
          department: "Marketing",
          skills: ["SEO", "Content Marketing", "Social Media"],
          languages: ["English", "Dutch"],
        },
        {
          id: 13,
          employeeCode: "1000013",
          name: "Kevin Red",
          dob: "1992-01-21",
          designation: "Sales Manager",
          department: "Sales",
          skills: ["Sales", "Negotiation", "CRM"],
          languages: ["English", "Spanish"],
        },
        {
          id: 14,
          employeeCode: "1000014",
          name: "Laura Silver",
          dob: "1995-11-03",
          designation: "Financial Analyst",
          department: "Finance",
          skills: ["Accounting", "Excel", "Financial Modeling"],
          languages: ["English", "French"],
        },
        {
          id: 15,
          employeeCode: "1000015",
          name: "Michael Gold",
          dob: "1984-03-15",
          designation: "Chief Technology Officer",
          department: "IT",
          skills: ["Leadership", "Technical Strategy", "Innovation"],
          languages: ["English", "German"],
        },
        {
          id: 16,
          employeeCode: "1000016",
          name: "Nina Violet",
          dob: "1989-06-18",
          designation: "Customer Support",
          department: "Support",
          skills: ["Customer Service", "Troubleshooting", "Communication"],
          languages: ["English", "Japanese"],
        },
        {
          id: 17,
          employeeCode: "1000017",
          name: "Oliver Pink",
          dob: "1991-12-31",
          designation: "Network Engineer",
          department: "IT",
          skills: ["Cisco", "Routing", "Switching"],
          languages: ["English", "Chinese"],
        },
        {
          id: 18,
          employeeCode: "1000018",
          name: "Paula Grey",
          dob: "1993-05-07",
          designation: "Product Manager",
          department: "Product",
          skills: ["Product Management", "Roadmapping", "User Research"],
          languages: ["English", "Korean"],
        },
        {
          id: 19,
          employeeCode: "1000019",
          name: "Quinn Brown",
          dob: "1996-02-11",
          designation: "Graphic Designer",
          department: "Design",
          skills: ["Illustrator", "Photoshop", "InDesign"],
          languages: ["English", "Russian"],
        },
        {
          id: 20,
          employeeCode: "1000020",
          name: "Rachel Green",
          dob: "1987-07-23",
          designation: "Operations Manager",
          department: "Operations",
          skills: ["Operations Management", "Logistics", "Process Improvement"],
          languages: ["English", "Portuguese"],
        },
      ].map(({ id, employeeCode }) => ({
        id,
        employeeCode,
      }));

      ///////////

      // Function to generate a date range array
      const generateDateRange = (startDate, endDate) => {
        let start = moment(startDate, "DD/MMM/YYYY");
        let end = moment(endDate, "DD/MMM/YYYY");
        let dateArray = [];

        while (start <= end) {
          dateArray.push(start.format("DD/MMM/YYYY"));
          start = start.add(1, "days");
        }

        return dateArray;
      };

      // // Function to generate employee attendance data
      // const generateEmployeeAttendanceData = (employees, dateRange) => {
      //   let [startDate, endDate] = dateRange.split(" - ");
      //   let dateArray = generateDateRange(startDate, endDate);
      //   let attendanceData = [];

      //   employees.forEach((employee) => {
      //     dateArray.forEach((date) => {
      //       attendanceData.push({
      //         employeeCode: employee.employeeCode,
      //         date: date,
      //         isPresent: Math.random() < 0.8, // 80% chance of being present
      //       });
      //     });
      //   });

      //   return attendanceData;
      // };

      // Function to generate employee attendance data
      const generateEmployeeAttendanceData = (employees, dateRange) => {
        debugger;
        let startDate, endDate;

        if (!dateRange) {
          const now = new Date();
          endDate = new Date(now.getFullYear(), now.getMonth(), 0); // Last day of the previous month
          startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1); // First day of the previous month
          startDate = moment(startDate).format("DD/MMM/YYYY");
          endDate = moment(endDate).format("DD/MMM/YYYY");
        } else {
          [startDate, endDate] = dateRange.split(" - ");
        }

        const dateArray = generateDateRange(startDate, endDate);
        const attendanceData = [];

        employees.forEach((employee) => {
          dateArray.forEach((date) => {
            attendanceData.push({
              employeeCode: employee.employeeCode,
              date: date,
              isPresent: Math.random() < 0.8, // 80% chance of being present
            });
          });
        });

        return attendanceData;
      };

      // Example usage
      // const employees = [
      //   { id: 1, employeeCode: "1000001" },
      //   { id: 2, employeeCode: "1000002" },
      // ];

      // const dateRange = "01/Jan/2024 - 10/Jan/2024";

      const employeeAttendanceData =
        generateEmployeeAttendanceData(employeeData);

      //////////////////////////////////////////////////////////

      // Helper function to generate table styles
      const styles = {
        table: {
          width: "100%",
          borderCollapse: "collapse",
        },
        th: {
          backgroundColor: "#f2f2f2",
          border: "1px solid #ddd",
          padding: "8px",
          textAlign: "left",
        },
        td: {
          border: "1px solid #ddd",
          padding: "8px",
        },
        tr: {
          "&:nth-child(even)": {
            backgroundColor: "#f9f9f9",
          },
          "&:hover": {
            backgroundColor: "#ddd",
          },
        },
        container: {
          margin: "20px 0",
          fontFamily: "Arial, sans-serif",
        },
      };

      // Function to generate table for attendance data
      const generateAttendanceTable = (attendanceData) => {
        // Create table element
        const table = document.createElement("table");
        Object.assign(table.style, styles.table);

        // Create table header
        const thead = table.createTHead();
        const headerRow = thead.insertRow();
        ["Employee Code", "Date", "Is Present"].forEach((text) => {
          const th = document.createElement("th");
          Object.assign(th.style, styles.th);
          th.textContent = text;
          headerRow.appendChild(th);
        });

        // Create table body
        const tbody = table.createTBody();
        attendanceData.forEach((record) => {
          const row = tbody.insertRow();
          Object.assign(row.style, styles.tr);

          const cellEmployeeCode = row.insertCell();
          Object.assign(cellEmployeeCode.style, styles.td);
          cellEmployeeCode.textContent = record.employeeCode;

          const cellDate = row.insertCell();
          Object.assign(cellDate.style, styles.td);
          cellDate.textContent = record.date;

          const cellIsPresent = row.insertCell();
          Object.assign(cellIsPresent.style, styles.td);
          cellIsPresent.textContent = record.isPresent ? "Yes" : "No";
        });

        return table;
      };

      // Function to render the table to the document
      const renderTable = (attendanceData) => {
        const container = document.createElement("div");
        Object.assign(container.style, styles.container);
        container.appendChild(generateAttendanceTable(attendanceData));
        document.body.appendChild(container);
      };

      // Sample data
      const attendanceData = [
        { employeeCode: "1000001", date: "2024-07-01", isPresent: true },
        { employeeCode: "1000001", date: "2024-07-02", isPresent: false },
        { employeeCode: "1000002", date: "2024-07-01", isPresent: true },
        { employeeCode: "1000002", date: "2024-07-02", isPresent: true },
      ];

      // Render table with sample data
      console.log(
        "employeeAttendanceData: ",
        JSON.stringify(employeeAttendanceData, null, 2)
      );
      renderTable(employeeAttendanceData);
    </script>
  </body>
</html>
